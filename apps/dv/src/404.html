<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>DV - Loyalty Program</title>
    <script type="text/javascript">
      // Single Page Apps for GitHub Pages
      // MIT License
      // https://github.com/rafgraph/spa-github-pages
      // This script handles routing for GitHub Pages with custom domains

      // Define valid routes that should be redirected
      var validRoutes = [
        "/",
        "/dashboard",
        "/admin",
        "/auth/login",
        "/auth/signup",
      ];

      // For custom domains, we keep 0 path segments, for GitHub Pages subdirectory we keep 1
      var pathSegmentsToKeep =
        window.location.hostname === "localhost" ||
        window.location.hostname.includes("github.io")
          ? 1
          : 0;

      var l = window.location;
      var currentPath = l.pathname
        .slice(1)
        .split("/")
        .slice(pathSegmentsToKeep)
        .join("/");

      // Check if this is a valid route or if it looks like a valid route pattern
      var isValidRoute =
        validRoutes.includes("/" + currentPath) ||
        currentPath.startsWith("auth/") ||
        currentPath.startsWith("dashboard") ||
        currentPath.startsWith("admin");

      // Only redirect if it's a valid route, otherwise let React Router handle it
      if (isValidRoute) {
        l.replace(
          l.protocol +
            "//" +
            l.hostname +
            (l.port ? ":" + l.port : "") +
            l.pathname
              .split("/")
              .slice(0, 1 + pathSegmentsToKeep)
              .join("/") +
            "/?/" +
            l.pathname
              .slice(1)
              .split("/")
              .slice(pathSegmentsToKeep)
              .join("/")
              .replace(/&/g, "~and~") +
            (l.search ? "&" + l.search.slice(1).replace(/&/g, "~and~") : "") +
            l.hash
        );
      } else {
        // For invalid routes, redirect to the main app and let React Router show 404
        l.replace(
          l.protocol +
            "//" +
            l.hostname +
            (l.port ? ":" + l.port : "") +
            l.pathname
              .split("/")
              .slice(0, 1 + pathSegmentsToKeep)
              .join("/") +
            "/?/404"
        );
      }
    </script>
  </head>
  <body></body>
</html>
